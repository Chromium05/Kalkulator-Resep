<!DOCTYPE html>
<html lang="id">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Kalkulator Biaya Resep</title>
</head>
<body>
    <header class="main-header text-center">
        <div class="container">
            <h1><i class="fas fa-calculator"></i> Kalkulator Biaya Resep</h1>
            <p class="subtitle">Kelola bahan dan hitung biaya resep dengan mudah</p>
        </div>
    </header>

    <div class="container">
        <!-- Ingredient Management Section -->
        <div class="modern-card">
            <div class="modern-card-header">
                <h5><i class="fas fa-plus-circle icon"></i>Tambah Bahan Baru</h5>
            </div>
            <div class="modern-card-body">
                <form id="ingredientForm" class="ingredient-form">
                    <div class="row g-3 align-items-end">
                        <div class="col-md-3">
                            <label for="ingredientName" class="modern-form-label">Nama Bahan</label>
                            <input type="text" id="ingredientName" class="form-control modern-form-control" placeholder="Contoh: Beras" autocomplete="off" required>
                        </div>
                        <div class="col-md-2">
                            <label for="ingredientPrice" class="modern-form-label">Harga (Rp)</label>
                            <input type="number" id="ingredientPrice" class="form-control modern-form-control" placeholder="75000" required>
                        </div>
                        <div class="col-md-2">
                            <label for="ingredientQuantity" class="modern-form-label">Jumlah</label>
                            <input type="number" id="ingredientQuantity" class="form-control modern-form-control" placeholder="1" value="1" required>
                        </div>
                        <div class="col-md-3">
                            <label for="unitType" class="modern-form-label">Satuan</label>
                            <select id="unitType" class="form-select modern-form-control" required>
                                <option value="kg">Kilogram</option>
                                <option value="liter">Liter</option>
                                <option value="ml">Mililiter</option>
                                <option value="piece(s)">Buah/Pcs</option>
                                <option value="gram">Gram</option>
                                <option value="butir">Butir</option>
                                <option value="ikat">Ikat</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button type="submit" class="modern-btn modern-btn-primary w-100">
                                <i class="fas fa-plus"></i> Tambah
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Ingredients List Section -->
        <div class="modern-card">
            <div class="modern-card-header">
                <h5><i class="fas fa-list icon"></i>Daftar Bahan</h5>
            </div>
            <div class="modern-card-body">
                <!-- Pagination controls at the top -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div class="d-flex align-items-center gap-2">
                        <label for="itemsPerPage" class="modern-form-label mb-0">Tampilkan:</label>
                        <select id="itemsPerPage" class="form-select modern-form-control" style="width: auto;">
                            <option value="5" selected>5</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                    <div id="ingredientInfo" class="text-muted">
                        <!-- Will show "Showing X-Y of Z ingredients" -->
                    </div>
                </div>
                
                <div id="ingredientList"></div>
                
                <!-- Pagination navigation -->
                <nav aria-label="Ingredients pagination" class="mt-4">
                    <ul class="pagination pagination-modern justify-content-center" id="ingredientPagination">
                        <!-- Pagination buttons will be generated here -->
                    </ul>
                </nav>
            </div>
        </div>

        <!-- Recipe Builder Section -->
        <div class="modern-card">
            <div class="modern-card-header">
                <h5><i class="fas fa-utensils icon"></i>Buat Resep Baru</h5>
            </div>
            <div class="modern-card-body">
                <form id="recipeForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="recipeName" class="modern-form-label">Nama Resep</label>
                                <input type="text" class="form-control modern-form-control" id="recipeName" placeholder="Contoh: Nasi Goreng Spesial" autocomplete="off" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="servings" class="modern-form-label">Jumlah Porsi</label>
                                <input type="number" class="form-control modern-form-control" id="servings" placeholder="4" required>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label for="ingredientSelect" class="modern-form-label">Pilih Bahan</label>
                                <select class="form-select modern-form-control" id="ingredientSelect">
                                    <option value="">Pilih bahan...</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="ingredientSelectQuantity" class="modern-form-label">Jumlah (kg)</label>
                                <input type="number" class="form-control modern-form-control" id="ingredientSelectQuantity" placeholder="0.5" step="0.1">
                            </div>
                        </div>
                    </div>

                    <button type="button" class="modern-btn modern-btn-secondary mb-4" id="addIngredientToRecipe">
                        <i class="fas fa-plus"></i> Tambah ke Resep
                    </button>

                    <div class="selected-ingredients mb-4">
                        <h6 class="mb-3"><i class="fas fa-shopping-basket"></i> Bahan yang Dipilih:</h6>
                        <div id="selectedIngredientsList"></div>
                    </div>

                    <div class="mb-4">
                        <label for="cookingInstructions" class="modern-form-label">Cara Memasak (Opsional)</label>
                        <textarea class="form-control modern-form-control" id="cookingInstructions" rows="4" placeholder="Masukkan langkah-langkah memasak..."></textarea>
                    </div>

                    <div class="cost-display">
                        <div class="row text-center">
                            <div class="col-md-6">
                                <h5><i class="fas fa-calculator"></i> Total Biaya: <span id="totalCostDisplay">Rp 0</span></h5>
                            </div>
                            <div class="col-md-6">
                                <h5><i class="fas fa-divide"></i> Biaya Per Porsi: <span id="costPerServingDisplay">Rp 0</span></h5>
                            </div>
                        </div>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="modern-btn modern-btn-primary">
                            <i class="fas fa-save"></i> Simpan Resep
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Saved Recipes Section -->
        <div class="modern-card">
            <div class="modern-card-header">
                <h5><i class="fas fa-book icon"></i>Resep Tersimpan</h5>
            </div>
            <div class="modern-card-body">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="Cari resep..." id="searchInput">
                </div>

                <!-- Display saved recipes here -->
                <div id="recipesList">
                    <!-- Each recipe will be a card with name, total cost, cost per serving, creation date, and delete button -->
                </div>

                <div class="d-none" id="noRecipesFound">
                    <div class="text-center py-5">
                        <i class="fas fa-utensils" style="font-size: 3rem; color: var(--text-secondary); margin-bottom: 1rem;"></i>
                        <p class="text-muted">Anda belum memiliki resep yang disimpan.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Ingredient Modal -->
    <div class="modal fade modal-modern" id="editIngredientModal" tabindex="-1" aria-labelledby="editIngredientModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <form id="editIngredientForm" class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editIngredientModalLabel"><i class="fas fa-edit"></i> Edit Bahan</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
              <input type="hidden" id="editIngredientIndex">
              <div class="mb-3">
                  <label for="editIngredientName" class="modern-form-label">Nama Bahan</label>
                  <input type="text" id="editIngredientName" class="form-control modern-form-control" required>
              </div>
              <div class="mb-3">
                  <label for="editIngredientPrice" class="modern-form-label">Harga (Rp)</label>
                  <input type="number" id="editIngredientPrice" class="form-control modern-form-control" required>
              </div>
              <div class="mb-3">
                  <label for="editIngredientQuantity" class="modern-form-label">Jumlah</label>
                  <input type="number" id="editIngredientQuantity" class="form-control modern-form-control" required>
              </div>
              <div class="mb-3">
                  <label for="editUnitType" class="modern-form-label">Satuan</label>
                  <select id="editUnitType" class="form-select modern-form-control" required>
                      <option value="kg">Kilogram</option>
                      <option value="liter">Liter</option>
                      <option value="ml">Mililiter</option>
                      <option value="piece(s)">Buah</option>
                      <option value="gram">Gram</option>
                      <option value="butir">Butir</option>
                      <option value="ikat">Ikat</option>                      
                  </select>
              </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="modern-btn modern-btn-outline" data-bs-dismiss="modal">Batal</button>
            <button type="submit" class="modern-btn modern-btn-primary">
                <i class="fas fa-save"></i> Simpan
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Recipe Detail Modal -->
    <div class="modal fade modal-modern" id="recipeDetailModal" tabindex="-1" aria-labelledby="recipeDetailModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="recipeDetailModalLabel"><i class="fas fa-info-circle"></i> Detail Resep</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="recipeDetailContent">
              <!-- Recipe details will be populated here -->
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="modern-btn modern-btn-outline" data-bs-dismiss="modal">Tutup</button>
            <button type="button" class="modern-btn modern-btn-warning" id="editRecipeBtn">
                <i class="fas fa-edit"></i> Edit
            </button>
            <button type="button" class="modern-btn modern-btn-danger" id="deleteRecipeBtn">
                <i class="fas fa-trash"></i> Hapus
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Recipe Modal -->
    <div class="modal fade modal-modern" id="editRecipeModal" tabindex="-1" aria-labelledby="editRecipeModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <form id="editRecipeForm" class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editRecipeModalLabel"><i class="fas fa-edit"></i> Edit Resep</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="editRecipeIndex">
            <div class="mb-3">
              <label for="editRecipeName" class="modern-form-label">Nama Resep</label>
              <input type="text" class="form-control modern-form-control" id="editRecipeName" required>
            </div>
            <div class="mb-3">
              <label for="editRecipeServings" class="modern-form-label">Jumlah Porsi</label>
              <input type="number" class="form-control modern-form-control" id="editRecipeServings" required>
            </div>
            <div class="mb-3">
              <label for="editRecipeCookingInstructions" class="modern-form-label">Cara Memasak (Opsional)</label>
              <textarea class="form-control modern-form-control" id="editRecipeCookingInstructions" rows="4" placeholder="Masukkan langkah-langkah memasak..."></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="modern-btn modern-btn-outline" data-bs-dismiss="modal">Batal</button>
            <button type="submit" class="modern-btn modern-btn-primary">
                <i class="fas fa-save"></i> Simpan
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Ingredient Deletion Warning Modal -->
    <div class="modal fade modal-modern" id="ingredientDeletionWarningModal" tabindex="-1" aria-labelledby="ingredientDeletionWarningModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="ingredientDeletionWarningModalLabel"><i class="fas fa-exclamation-triangle"></i> Peringatan Hapus Bahan</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="alert-modern alert-warning">
              <strong><i class="fas fa-exclamation-triangle"></i> Perhatian!</strong> Bahan ini digunakan dalam resep berikut:
            </div>
            <div id="affectedRecipesList">
              <!-- List of affected recipes will be shown here -->
            </div>
            <p class="mt-3">Pilih tindakan yang ingin dilakukan:</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="modern-btn modern-btn-outline" data-bs-dismiss="modal">Batal</button>
            <button type="button" class="modern-btn modern-btn-warning" id="markUnavailableBtn">
                <i class="fas fa-eye-slash"></i> Tandai Tidak Tersedia
            </button>
            <button type="button" class="modern-btn modern-btn-danger" id="forceDeleteBtn">
                <i class="fas fa-trash-alt"></i> Hapus Paksa
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="ingredientScript.js"></script>
    <script src="recipeScript.js"></script>
</body>
</html>
